---
top: 7
sticky: 1000
sidebar:
  title: useRouteè·å–ä¸åˆ°è·¯ç”±å‚æ•°
  isTimeLine: true
title: useRouteè·å–ä¸åˆ°è·¯ç”±å‚æ•°
date: 2025-05-30 10:00:00
tags:
  - å‰ç«¯
  - javascript
  - Vue3
categories:
  - å‰ç«¯
---

# useRoute è·å–ä¸åˆ°è·¯ç”±å‚æ•°

åœ¨ Vue 3 ä¸­ï¼Œ`onMounted` ä¸­é€šè¿‡ `useRoute` è·å–ä¸åˆ°è·¯ç”±å‚æ•°çš„é—®é¢˜ï¼Œæ ¹æºåœ¨äº**ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ—¶åºã€è·¯ç”±åˆå§‹åŒ–æµç¨‹ä¸å“åº”å¼ä¾èµ–æ³¨å…¥çš„å†²çª**ã€‚ä»¥ä¸‹ä»æºç å±‚é¢åˆ†æåŸå› å’Œè§£å†³æ–¹æ¡ˆï¼š

---

### âš™ï¸ ä¸€ã€æ ¸å¿ƒæºç æœºåˆ¶åˆ†æ

#### 1. **`useRoute` çš„å“åº”å¼ä¾èµ–æ³¨å…¥åŸç†**

`useRoute` ä¾èµ– Vue Router çš„å…¨å±€æ³¨å…¥ä¸Šä¸‹æ–‡ï¼ˆ`inject(routerKey)`ï¼‰ã€‚åœ¨ç»„ä»¶ `setup` é˜¶æ®µï¼ŒVue Router é€šè¿‡ `provide(routerKey, router)` æ³¨å…¥è·¯ç”±å®ä¾‹ ã€‚

- **å…³é”®ç‚¹**ï¼š`useRoute` å¿…é¡»åœ¨åŒæ­¥çš„ `setup` æˆ– `<script setup>` ä¸­è°ƒç”¨ï¼Œæ‰èƒ½æ­£ç¡®è·å–æ³¨å…¥çš„ä¸Šä¸‹æ–‡ã€‚è‹¥åœ¨å¼‚æ­¥å›è°ƒï¼ˆå¦‚ `onMounted` ä¸­çš„ `setTimeout`ï¼‰ä¸­è°ƒç”¨ï¼Œå¯èƒ½å› ç»„ä»¶å®ä¾‹å·²å¸è½½è€Œæ— æ³•è·å–æ³¨å…¥å€¼ ã€‚

#### 2. **ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„æ—¶åºå†²çª**

- **`onMounted` çš„å¼‚æ­¥å›è°ƒå»¶è¿Ÿæ‰§è¡Œ**ï¼š  
  å½“ `onMounted` ä¸­çš„å¼‚æ­¥æ“ä½œï¼ˆå¦‚ `await fetchData()`ï¼‰å®Œæˆåï¼Œè‹¥çˆ¶ç»„ä»¶å·²è§¦å‘ `reset` æˆ–é‡æ–°æ¸²æŸ“ï¼Œå½“å‰ç»„ä»¶å®ä¾‹å¯èƒ½å·²è¢«é”€æ¯ï¼Œå¯¼è‡´ `useRoute` çš„ä¾èµ–æ³¨å…¥å¤±æ•ˆ ã€‚
  ```javascript
  onMounted(async () => {
    await fetchData() // å¼‚æ­¥æ“ä½œå»¶è¿Ÿ
    const route = useRoute() // æ­¤æ—¶ç»„ä»¶å®ä¾‹å¯èƒ½å·²è¢«é‡ç½®
  })
  ```
- **æºç ä¸­çš„é‡ç½®é€»è¾‘**ï¼š  
  Vue 3 çš„ç»„ä»¶å¸è½½æµç¨‹ä¼šæ¸…é™¤å“åº”å¼ä¾èµ–ï¼ˆå¦‚ `inject` çš„ä¸Šä¸‹æ–‡ï¼‰ã€‚è‹¥å¼‚æ­¥æ“ä½œå®Œæˆæ—¶ç»„ä»¶å·²å¸è½½ï¼Œ`useRoute` å°†è¿”å› `undefined` ã€‚

#### 3. **Vue Router çš„ç»„ä»¶å¤ç”¨ç­–ç•¥**

Vue Router é»˜è®¤**å¤ç”¨åŒä¸€ç»„ä»¶**ï¼ˆä¾‹å¦‚ä» `/user/1` è·³è½¬åˆ° `/user/2`ï¼‰ï¼Œä»…æ›´æ–°è·¯ç”±å‚æ•°è€Œä¸è§¦å‘ç»„ä»¶é‡å»ºã€‚æ­¤æ—¶ `onMounted` **ä¸ä¼šé‡æ–°æ‰§è¡Œ**ï¼Œä½† `route` å¯¹è±¡ä¼šå“åº”å¼æ›´æ–° ã€‚

- è‹¥çˆ¶ç»„ä»¶å¼ºåˆ¶é‡ç½®å­ç»„ä»¶ï¼ˆå¦‚é€šè¿‡ `v-if`ï¼‰ï¼Œå­ç»„ä»¶å®ä¾‹é”€æ¯é‡å»ºï¼Œå¼‚æ­¥å›è°ƒä¸­çš„ `useRoute` å¯èƒ½å› æ³¨å…¥ä¸¢å¤±è€Œå¤±è´¥ ã€‚

---

### ğŸ”§ äºŒã€è§£å†³æ–¹æ¡ˆä¸æœ€ä½³å®è·µ

#### 1. **åœ¨åŒæ­¥ä¸Šä¸‹æ–‡ä¸­è·å–è·¯ç”±å¯¹è±¡**

å°† `useRoute` ç§»è‡³ `setup` é¡¶å±‚ï¼Œé€šè¿‡ `watch` ç›‘å¬å‚æ•°å˜åŒ–ï¼š

```javascript
import { useRoute } from 'vue-router'
import { watch } from 'vue'

const route = useRoute() // åŒæ­¥è·å–å“åº”å¼ route å¯¹è±¡

watch(
  () => route.params.id,
  newId => {
    // å¤„ç†å‚æ•°å˜åŒ–
  },
  { immediate: true }
) // ç«‹å³æ‰§è¡Œä»¥æ•è·åˆå§‹å€¼
```

**ä¼˜åŠ¿**ï¼šé¿å…ä¾èµ–å¼‚æ­¥æ—¶åºï¼Œç›´æ¥åˆ©ç”¨å“åº”å¼ç³»ç»Ÿ ã€‚

#### 2. **ä½¿ç”¨å¯¼èˆªå®ˆå«æ›¿ä»£ç”Ÿå‘½å‘¨æœŸé’©å­**

å¯¹äºåŒä¸€ç»„ä»¶å†…çš„å‚æ•°æ›´æ–°ï¼Œä½¿ç”¨ `onBeforeRouteUpdate`ï¼š

```javascript
import { onBeforeRouteUpdate } from 'vue-router'

onBeforeRouteUpdate(to => {
  console.log('æ–°å‚æ•°:', to.params.id) // ç›´æ¥è®¿é—®æœ€æ–°å‚æ•°
})
```

**é€‚ç”¨åœºæ™¯**ï¼šè·¯ç”±è·³è½¬æ—¶ç»„ä»¶å¤ç”¨çš„æƒ…å†µ ã€‚

#### 3. **é¿å…åœ¨å¼‚æ­¥å›è°ƒä¸­è°ƒç”¨ `useRoute`**

è‹¥å¿…é¡»åœ¨ `onMounted` ä¸­å¤„ç†å¼‚æ­¥é€»è¾‘ï¼Œ**æå‰ä¿å­˜ `route` å¼•ç”¨**ï¼š

```javascript
const route = useRoute() // åŒæ­¥ä¿å­˜

onMounted(async () => {
  await fetchData()
  console.log(route.params.id) // ä½¿ç”¨å·²ä¿å­˜çš„å“åº”å¼å¼•ç”¨
})
```

**åŸç†**ï¼š`route` æ˜¯å“åº”å¼å¯¹è±¡ï¼Œå…¶å±æ€§å˜æ›´ä¼šè‡ªåŠ¨æ›´æ–° ã€‚

#### 4. **å¼ºåˆ¶ç»„ä»¶é‡å»ºä»¥è§¦å‘ç”Ÿå‘½å‘¨æœŸ**

å½“çˆ¶ç»„ä»¶éœ€è¦é‡ç½®å­ç»„ä»¶æ—¶ï¼Œå¯é€šè¿‡ `key` ç»‘å®šè·¯ç”±å‚æ•°å¼ºåˆ¶é‡å»ºï¼š

```vue
<template>
  <ChildComponent :key="route.params.id" />
</template>
```

**æ•ˆæœ**ï¼šå‚æ•°å˜åŒ–æ—¶å­ç»„ä»¶é”€æ¯é‡å»ºï¼Œè§¦å‘å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸ ã€‚

---

### ğŸ’ ä¸‰ã€æ€»ç»“ï¼šé—®é¢˜æ ¹æºä¸è§„é¿ç­–ç•¥

| **å…³é”®å› ç´ **                | **å¯¼è‡´é—®é¢˜åŸå› **                       | **è§„é¿æ–¹æ¡ˆ**                    |
| --------------------------- | -------------------------------------- | ------------------------------- |
| **`useRoute` ä¾èµ–æ³¨å…¥ä¸¢å¤±** | å¼‚æ­¥å›è°ƒæ‰§è¡Œæ—¶ç»„ä»¶å®ä¾‹å·²é”€æ¯           | åœ¨ `setup` é¡¶å±‚åŒæ­¥è·å– `route` |
| **ç»„ä»¶å¤ç”¨ç­–ç•¥**            | `onMounted` ä¸é‡å¤è§¦å‘ï¼Œå‚æ•°æ›´æ–°æ— æ„ŸçŸ¥ | ä½¿ç”¨ `onBeforeRouteUpdate` ç›‘å¬ |
| **çˆ¶ç»„ä»¶é‡ç½®å­ç»„ä»¶**        | å­ç»„ä»¶å®ä¾‹é”€æ¯å¯¼è‡´å¼‚æ­¥å›è°ƒä¸Šä¸‹æ–‡å¤±æ•ˆ   | æå‰ä¿å­˜ `route` æˆ–ç»‘å®š `key`   |

> **æºç è®¾è®¡ç»“è®º**ï¼š  
> Vue Router çš„ `useRoute` é«˜åº¦ä¾èµ–**åŒæ­¥çš„ä¾èµ–æ³¨å…¥æœºåˆ¶**ï¼Œè€Œ Vue ç»„ä»¶çš„å¸è½½æ˜¯åŒæ­¥è¿‡ç¨‹ã€‚å¼‚æ­¥æ“ä½œï¼ˆå¦‚ `onMounted` ä¸­çš„ `await`ï¼‰å®Œæˆåï¼Œè‹¥ç»„ä»¶å·²è¢«é‡ç½®ï¼Œæ³¨å…¥çš„è·¯ç”±ä¸Šä¸‹æ–‡ä¼šè¢«æ¸…é™¤ï¼Œå¯¼è‡´ `useRoute` è¿”å› `undefined`ã€‚å› æ­¤ï¼ŒåŠ¡å¿…åœ¨åŒæ­¥ä¸Šä¸‹æ–‡ä¸­è·å–è·¯ç”±å¯¹è±¡ï¼Œå†åœ¨å¼‚æ­¥é€»è¾‘ä¸­ä½¿ç”¨å…¶å¼•ç”¨ã€‚
