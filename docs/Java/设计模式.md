# Java è®¾è®¡æ¨¡å¼å¤§æ­ç§˜ï¼š23 ç§æ¨¡å¼å…¨è§£æ

## ğŸ“š è®¾è®¡æ¨¡å¼åˆ†ç±»

Java è®¾è®¡æ¨¡å¼åˆ†ä¸ºä¸‰å¤§ç±»ï¼Œå°±åƒç¾é£Ÿç•Œçš„"ä¸­é¤ã€è¥¿é¤ã€æ—¥æ–™"ï¼Œå„æœ‰ç‰¹è‰²ï¼š

### ä¸€ã€åˆ›å»ºå‹æ¨¡å¼ï¼ˆ5 ç§ï¼‰ï¼šè§£å†³"ç”Ÿå­©å­"çš„é—®é¢˜

#### 1. å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰

**æ¯”å–»**ï¼šå°±åƒå›½å®¶æ€»ç»Ÿï¼Œä¸€ä¸ªå›½å®¶åªèƒ½æœ‰ä¸€ä¸ªæ€»ç»Ÿï¼Œæ‰€æœ‰éƒ¨é—¨éƒ½æ‰¾åŒä¸€ä¸ªäººåŠäº‹ã€‚

**åº”ç”¨åœºæ™¯**ï¼šæ—¥å¿—ç®¡ç†å™¨ã€æ•°æ®åº“è¿æ¥æ± ã€é…ç½®ä¸­å¿ƒï¼ˆä¸€ä¸ªç³»ç»Ÿé‡Œåªéœ€è¦ä¸€ä¸ªå®ä¾‹ï¼‰ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// æšä¸¾å•ä¾‹ï¼ˆæœ€æ¨èçš„æ–¹å¼ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œé˜²æ­¢åå°„æ”»å‡»ï¼‰
public enum Singleton {
    INSTANCE;

    public String getConfig() {
        return "é…ç½®ä¿¡æ¯";
    }
}

// ä½¿ç”¨
Singleton instance = Singleton.INSTANCE;
System.out.println(instance.getConfig()); // è¾“å‡ºï¼šé…ç½®ä¿¡æ¯
```

**ä¸ºä»€ä¹ˆå¥½**ï¼šé¿å…èµ„æºæµªè´¹ï¼Œé˜²æ­¢å¤šä¸ªå®ä¾‹å¯¼è‡´å†²çªï¼Œä»£ç ç®€æ´ã€‚

#### 2. å·¥å‚æ–¹æ³•æ¨¡å¼ï¼ˆFactory Methodï¼‰

**æ¯”å–»**ï¼šå°±åƒç‚¹å¤–å–ï¼Œä½ åªéœ€è¦è¯´"æˆ‘è¦ä¸€ä»½æŠ«è¨"ï¼Œä¸ç”¨å…³å¿ƒæ˜¯å“ªå®¶åº—åšçš„ã€‚

**åº”ç”¨åœºæ™¯**ï¼šå¯¹è±¡åˆ›å»ºé€»è¾‘å¤æ‚ï¼Œéœ€è¦è§£è€¦åˆ›å»ºå’Œä½¿ç”¨ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// äº§å“æ¥å£
interface Car {
    void drive();
}

// å…·ä½“äº§å“
class SUV implements Car {
    public void drive() {
        System.out.println("è¶Šé‡è½¦è¡Œé©¶");
    }
}

// å·¥å‚ç±»
class CarFactory {
    public Car createCar(String type) {
        if ("SUV".equals(type)) {
            return new SUV();
        }
        return null;
    }
}

// ä½¿ç”¨
Car myCar = new CarFactory().createCar("SUV");
myCar.drive(); // è¾“å‡ºï¼šè¶Šé‡è½¦è¡Œé©¶
```

#### 3. æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factoryï¼‰

**æ¯”å–»**ï¼šå°±åƒè‹¹æœç”Ÿæ€ï¼ŒiPhone å’Œ AirPods ä¸€èµ·å–ï¼Œå°ç±³æ‰‹æœºå’Œè€³æœºä¸€èµ·å–ã€‚

**åº”ç”¨åœºæ™¯**ï¼šéœ€è¦åˆ›å»ºç›¸å…³äº§å“å®¶æ—ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
interface Phone {
    void call();
}

interface Earphone {
    void play();
}

// è‹¹æœäº§å“å®¶æ—
class iPhone implements Phone {
    public void call() {
        System.out.println("iPhoneæ‰“ç”µè¯");
    }
}

class AirPods implements Earphone {
    public void play() {
        System.out.println("AirPodsæ’­æ”¾éŸ³ä¹");
    }
}

// å·¥å‚æ¥å£
interface TechFactory {
    Phone createPhone();
    Earphone createEarphone();
}

// è‹¹æœå·¥å‚
class AppleFactory implements TechFactory {
    public Phone createPhone() {
        return new iPhone();
    }

    public Earphone createEarphone() {
        return new AirPods();
    }
}

// ä½¿ç”¨
TechFactory appleFactory = new AppleFactory();
Phone phone = appleFactory.createPhone();
Earphone earphone = appleFactory.createEarphone();
phone.call(); // iPhoneæ‰“ç”µè¯
earphone.play(); // AirPodsæ’­æ”¾éŸ³ä¹
```

#### 4. å»ºé€ è€…æ¨¡å¼ï¼ˆBuilderï¼‰

**æ¯”å–»**ï¼šå°±åƒç‚¹å’–å•¡ï¼Œä½ å‘Šè¯‰åº—å‘˜"è¦å¤§æ¯ã€çƒ­çš„ã€åŠ å¥¶ã€ä¸åŠ ç³–"ï¼Œåº—å‘˜æŒ‰ç…§ä½ çš„è¦æ±‚åˆ¶ä½œã€‚

**åº”ç”¨åœºæ™¯**ï¼šå¯¹è±¡åˆ›å»ºè¿‡ç¨‹å¤æ‚ï¼Œå‚æ•°å¤šä¸”æœ‰ä¾èµ–å…³ç³»ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
class Coffee {
    private int size;
    private boolean hot;
    private boolean milk;
    private boolean sugar;

    private Coffee(Builder builder) {
        this.size = builder.size;
        this.hot = builder.hot;
        this.milk = builder.milk;
        this.sugar = builder.sugar;
    }

    public static class Builder {
        private int size;
        private boolean hot = true;
        private boolean milk;
        private boolean sugar;

        public Builder size(int size) {
            this.size = size;
            return this;
        }

        public Builder hot(boolean hot) {
            this.hot = hot;
            return this;
        }

        public Builder milk(boolean milk) {
            this.milk = milk;
            return this;
        }

        public Builder sugar(boolean sugar) {
            this.sugar = sugar;
            return this;
        }

        public Coffee build() {
            return new Coffee(this);
        }
    }

    @Override
    public String toString() {
        return "Coffee{" +
                "size=" + size +
                ", hot=" + hot +
                ", milk=" + milk +
                ", sugar=" + sugar +
                '}';
    }
}

// ä½¿ç”¨
Coffee coffee = new Coffee.Builder()
        .size(300)
        .hot(false)
        .milk(true)
        .sugar(false)
        .build();
System.out.println(coffee); // Coffee{size=300, hot=false, milk=true, sugar=false}
```

#### 5. åŸå‹æ¨¡å¼ï¼ˆPrototypeï¼‰

**æ¯”å–»**ï¼šå°±åƒå¤å°æœºï¼Œä½ åªéœ€è¦ä¸€å¼ çº¸ï¼Œå°±å¯ä»¥å¿«é€Ÿå¤åˆ¶å‡ºå¤šä»½ç›¸åŒå†…å®¹ã€‚

**åº”ç”¨åœºæ™¯**ï¼šåˆ›å»ºå¯¹è±¡æˆæœ¬é«˜ï¼Œéœ€è¦å¿«é€Ÿå¤åˆ¶å·²æœ‰å¯¹è±¡ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
class Shape implements Cloneable {
    private String type;

    public Shape(String type) {
        this.type = type;
    }

    public String getType() {
        return type;
    }

    @Override
    protected Object clone() throws CloneNotSupportedException {
        return super.clone();
    }
}

// ä½¿ç”¨
Shape circle = new Shape("Circle");
Shape clonedCircle = (Shape) circle.clone();
System.out.println(clonedCircle.getType()); // Circle
```

### äºŒã€ç»“æ„å‹æ¨¡å¼ï¼ˆ7 ç§ï¼‰ï¼šè§£å†³"å¦‚ä½•ç»„åˆ"çš„é—®é¢˜

#### 6. é€‚é…å™¨æ¨¡å¼ï¼ˆAdapterï¼‰

**æ¯”å–»**ï¼šå°±åƒæ‰‹æœºå……ç”µå™¨çš„è½¬æ¥å¤´ï¼ŒæŠŠä¸åŒæ¥å£çš„å……ç”µå£è½¬æ¢æˆé€šç”¨çš„ã€‚

**åº”ç”¨åœºæ™¯**ï¼šå°†ä¸å…¼å®¹çš„æ¥å£è½¬æ¢æˆå…¼å®¹çš„æ¥å£ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// ç›®æ ‡æ¥å£
interface MediaPlayer {
    void play(String audioType, String fileName);
}

// é€‚é…è€…
class AdvancedMediaPlayer {
    public void playVlc(String fileName) {
        System.out.println("Playing vlc file. Name: " + fileName);
    }

    public void playMp4(String fileName) {
        System.out.println("Playing mp4 file. Name: " + fileName);
    }
}

// é€‚é…å™¨
class MediaAdapter implements MediaPlayer {
    private AdvancedMediaPlayer advancedMediaPlayer;

    public MediaAdapter(String audioType) {
        if ("vlc".equalsIgnoreCase(audioType)) {
            advancedMediaPlayer = new AdvancedMediaPlayer();
        } else if ("mp4".equalsIgnoreCase(audioType)) {
            advancedMediaPlayer = new AdvancedMediaPlayer();
        }
    }

    @Override
    public void play(String audioType, String fileName) {
        if ("vlc".equalsIgnoreCase(audioType)) {
            advancedMediaPlayer.playVlc(fileName);
        } else if ("mp4".equalsIgnoreCase(audioType)) {
            advancedMediaPlayer.playMp4(fileName);
        }
    }
}

// ä½¿ç”¨
MediaPlayer mediaPlayer = new MediaAdapter("vlc");
mediaPlayer.play("vlc", "movie.vlc"); // Playing vlc file. Name: movie.vlc
```

#### 7. è£…é¥°æ¨¡å¼ï¼ˆDecoratorï¼‰

**æ¯”å–»**ï¼šå°±åƒæŠ«è¨ï¼ŒåŸºç¡€æŠ«è¨æ˜¯æ ¸å¿ƒï¼ŒåŠ èŠå£«ã€ç«è…¿ã€è˜‘è‡éƒ½æ˜¯è£…é¥°ã€‚

**åº”ç”¨åœºæ™¯**ï¼šåŠ¨æ€åœ°ç»™å¯¹è±¡æ·»åŠ èŒè´£ï¼Œä¸ä½¿ç”¨ç»§æ‰¿ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// ç»„ä»¶æ¥å£
interface Coffee {
    String getDescription();
    double cost();
}

// å…·ä½“ç»„ä»¶
class SimpleCoffee implements Coffee {
    @Override
    public String getDescription() {
        return "Simple Coffee";
    }

    @Override
    public double cost() {
        return 1.0;
    }
}

// è£…é¥°å™¨
abstract class CoffeeDecorator implements Coffee {
    protected Coffee coffee;

    public CoffeeDecorator(Coffee coffee) {
        this.coffee = coffee;
    }

    @Override
    public String getDescription() {
        return coffee.getDescription();
    }

    @Override
    public double cost() {
        return coffee.cost();
    }
}

// å…·ä½“è£…é¥°å™¨
class MilkDecorator extends CoffeeDecorator {
    public MilkDecorator(Coffee coffee) {
        super(coffee);
    }

    @Override
    public String getDescription() {
        return super.getDescription() + ", Milk";
    }

    @Override
    public double cost() {
        return super.cost() + 0.5;
    }
}

// ä½¿ç”¨
Coffee coffee = new SimpleCoffee();
coffee = new MilkDecorator(coffee);
System.out.println(coffee.getDescription()); // Simple Coffee, Milk
System.out.println(coffee.cost()); // 1.5
```

#### 8. å¤–è§‚æ¨¡å¼ï¼ˆFacadeï¼‰

**æ¯”å–»**ï¼šå°±åƒæ‰‹æœº APPï¼Œä½ ä¸éœ€è¦çŸ¥é“æ‰‹æœºå†…éƒ¨æ€ä¹ˆè¿ä½œï¼Œåªéœ€è¦ç‚¹å‡ ä¸ªæŒ‰é’®ã€‚

**åº”ç”¨åœºæ™¯**ï¼šä¸ºå¤æ‚çš„å­ç³»ç»Ÿæä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// å­ç³»ç»Ÿ
class CPU {
    public void start() {
        System.out.println("CPU is starting...");
    }
}

class Memory {
    public void load() {
        System.out.println("Memory is loading...");
    }
}

class HardDrive {
    public void read() {
        System.out.println("Hard drive is reading...");
    }
}

// å¤–è§‚
class ComputerFacade {
    private CPU cpu;
    private Memory memory;
    private HardDrive hardDrive;

    public ComputerFacade() {
        this.cpu = new CPU();
        this.memory = new Memory();
        this.hardDrive = new HardDrive();
    }

    public void start() {
        cpu.start();
        memory.load();
        hardDrive.read();
        System.out.println("Computer started successfully!");
    }
}

// ä½¿ç”¨
ComputerFacade computer = new ComputerFacade();
computer.start();
// è¾“å‡ºï¼š
// CPU is starting...
// Memory is loading...
// Hard drive is reading...
// Computer started successfully!
```

#### 9. ä»£ç†æ¨¡å¼ï¼ˆProxyï¼‰

**æ¯”å–»**ï¼šå°±åƒç»çºªäººï¼Œä½ ä¸éœ€è¦ç›´æ¥å’Œæ˜æ˜Ÿæ¥è§¦ï¼Œé€šè¿‡ç»çºªäººå°±èƒ½å®‰æ’è§é¢ã€‚

**åº”ç”¨åœºæ™¯**ï¼šæ§åˆ¶å¯¹å¯¹è±¡çš„è®¿é—®ï¼Œå¦‚æƒé™æ§åˆ¶ã€å»¶è¿ŸåŠ è½½ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// æ¥å£
interface Image {
    void display();
}

// çœŸå®å¯¹è±¡
class RealImage implements Image {
    private String fileName;

    public RealImage(String fileName) {
        this.fileName = fileName;
        loadFromDisk();
    }

    private void loadFromDisk() {
        System.out.println("Loading " + fileName);
    }

    @Override
    public void display() {
        System.out.println("Displaying " + fileName);
    }
}

// ä»£ç†
class ProxyImage implements Image {
    private RealImage realImage;
    private String fileName;

    public ProxyImage(String fileName) {
        this.fileName = fileName;
    }

    @Override
    public void display() {
        if (realImage == null) {
            realImage = new RealImage(fileName);
        }
        realImage.display();
    }
}

// ä½¿ç”¨
Image image = new ProxyImage("test.jpg");
image.display(); // Loading test.jpg, Displaying test.jpg
image.display(); // Displaying test.jpg (ä¸å†åŠ è½½ï¼Œç›´æ¥æ˜¾ç¤º)
```

#### 10. æ¡¥æ¥æ¨¡å¼ï¼ˆBridgeï¼‰

**æ¯”å–»**ï¼šå°±åƒæ‰‹æœºå’Œ SIM å¡ï¼Œæ‰‹æœºï¼ˆæŠ½è±¡ï¼‰å’Œ SIM å¡ï¼ˆå®ç°ï¼‰å¯ä»¥åˆ†ç¦»ã€‚

**åº”ç”¨åœºæ™¯**ï¼šå°†æŠ½è±¡éƒ¨åˆ†ä¸å…¶å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// å®ç°ç±»æ¥å£
interface Implementor {
    void operationImpl();
}

// å…·ä½“å®ç°
class ConcreteImplementorA implements Implementor {
    @Override
    public void operationImpl() {
        System.out.println("ConcreteImplementorA operation");
    }
}

class ConcreteImplementorB implements Implementor {
    @Override
    public void operationImpl() {
        System.out.println("ConcreteImplementorB operation");
    }
}

// æŠ½è±¡ç±»
abstract class Abstraction {
    protected Implementor implementor;

    public Abstraction(Implementor implementor) {
        this.implementor = implementor;
    }

    public abstract void operation();
}

// æ‰©å±•æŠ½è±¡ç±»
class RefinedAbstraction extends Abstraction {
    public RefinedAbstraction(Implementor implementor) {
        super(implementor);
    }

    @Override
    public void operation() {
        System.out.println("RefinedAbstraction operation");
        implementor.operationImpl();
    }
}

// ä½¿ç”¨
Implementor implementorA = new ConcreteImplementorA();
Abstraction abstraction = new RefinedAbstraction(implementorA);
abstraction.operation();
// è¾“å‡ºï¼š
// RefinedAbstraction operation
// ConcreteImplementorA operation
```

#### 11. ç»„åˆæ¨¡å¼ï¼ˆCompositeï¼‰

**æ¯”å–»**ï¼šå°±åƒä¸€æ£µæ ‘ï¼Œæœ‰æ ¹èŠ‚ç‚¹ã€åˆ†æ”¯èŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹ï¼Œä½†å¯ä»¥ç»Ÿä¸€å¤„ç†ã€‚

**åº”ç”¨åœºæ™¯**ï¼šè¡¨ç¤ºå¯¹è±¡çš„"æ•´ä½“-éƒ¨åˆ†"å±‚æ¬¡ç»“æ„ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// ç»„ä»¶
abstract class Component {
    protected String name;

    public Component(String name) {
        this.name = name;
    }

    public abstract void add(Component component);
    public abstract void remove(Component component);
    public abstract void display(int depth);
}

// å¶å­èŠ‚ç‚¹
class Leaf extends Component {
    public Leaf(String name) {
        super(name);
    }

    @Override
    public void add(Component component) {
        System.out.println("Cannot add to a leaf");
    }

    @Override
    public void remove(Component component) {
        System.out.println("Cannot remove from a leaf");
    }

    @Override
    public void display(int depth) {
        System.out.println("-".repeat(depth) + name);
    }
}

// ç»„åˆèŠ‚ç‚¹
class Composite extends Component {
    private List<Component> children = new ArrayList<>();

    public Composite(String name) {
        super(name);
    }

    @Override
    public void add(Component component) {
        children.add(component);
    }

    @Override
    public void remove(Component component) {
        children.remove(component);
    }

    @Override
    public void display(int depth) {
        System.out.println("-".repeat(depth) + name);
        for (Component child : children) {
            child.display(depth + 2);
        }
    }
}

// ä½¿ç”¨
Component root = new Composite("Root");
Component branch1 = new Composite("Branch1");
Component leaf1 = new Leaf("Leaf1");
Component leaf2 = new Leaf("Leaf2");

branch1.add(leaf1);
branch1.add(leaf2);
root.add(branch1);

root.display(0);
// è¾“å‡ºï¼š
// Root
//   Branch1
//     Leaf1
//     Leaf2
```

#### 12. äº«å…ƒæ¨¡å¼ï¼ˆFlyweightï¼‰

**æ¯”å–»**ï¼šå°±åƒå›¾ä¹¦é¦†çš„ä¹¦ç±ï¼Œå¾ˆå¤šè¯»è€…çœ‹åŒä¸€æœ¬ä¹¦ï¼Œä½†ä¸éœ€è¦ä¸ºæ¯ä¸ªäººå¤åˆ¶ä¸€æœ¬ã€‚

**åº”ç”¨åœºæ™¯**ï¼šå…±äº«å¤§é‡ç»†ç²’åº¦å¯¹è±¡ï¼Œå‡å°‘å†…å­˜å ç”¨ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// äº«å…ƒ
interface Flyweight {
    void operation(String extrinsicState);
}

// å…·ä½“äº«å…ƒ
class ConcreteFlyweight implements Flyweight {
    private String intrinsicState;

    public ConcreteFlyweight(String intrinsicState) {
        this.intrinsicState = intrinsicState;
    }

    @Override
    public void operation(String extrinsicState) {
        System.out.println("Intrinsic: " + intrinsicState + ", Extrinsic: " + extrinsicState);
    }
}

// äº«å…ƒå·¥å‚
class FlyweightFactory {
    private Map<String, Flyweight> flyweights = new HashMap<>();

    public Flyweight getFlyweight(String intrinsicState) {
        if (!flyweights.containsKey(intrinsicState)) {
            flyweights.put(intrinsicState, new ConcreteFlyweight(intrinsicState));
        }
        return flyweights.get(intrinsicState);
    }
}

// ä½¿ç”¨
FlyweightFactory factory = new FlyweightFactory();
Flyweight flyweight1 = factory.getFlyweight("A");
Flyweight flyweight2 = factory.getFlyweight("B");
Flyweight flyweight3 = factory.getFlyweight("A");

flyweight1.operation("X"); // Intrinsic: A, Extrinsic: X
flyweight2.operation("Y"); // Intrinsic: B, Extrinsic: Y
flyweight3.operation("Z"); // Intrinsic: A, Extrinsic: Z
```

### ä¸‰ã€è¡Œä¸ºå‹æ¨¡å¼ï¼ˆ11 ç§ï¼‰ï¼šè§£å†³"å¦‚ä½•äº¤äº’"çš„é—®é¢˜

#### 13. è´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibilityï¼‰

**æ¯”å–»**ï¼šå°±åƒå…¬å¸å®¡æ‰¹æµç¨‹ï¼Œå°é—®é¢˜æ‰¾éƒ¨é—¨ç»ç†ï¼Œå¤§é—®é¢˜æ‰¾æ€»ç›‘ï¼Œæœ€ç»ˆæ‰¾ CEOã€‚

**åº”ç”¨åœºæ™¯**ï¼šå¤šä¸ªå¯¹è±¡å¯ä»¥å¤„ç†è¯·æ±‚ï¼Œä½†å…·ä½“å“ªä¸ªå¯¹è±¡å¤„ç†æœªçŸ¥ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// å¤„ç†è€…æ¥å£
abstract class Handler {
    protected Handler successor;

    public void setSuccessor(Handler successor) {
        this.successor = successor;
    }

    public abstract void handleRequest(String request);
}

// å…·ä½“å¤„ç†è€…
class Manager extends Handler {
    @Override
    public void handleRequest(String request) {
        if ("salary".equals(request)) {
            System.out.println("Manager handles salary request");
        } else if (successor != null) {
            successor.handleRequest(request);
        }
    }
}

class Director extends Handler {
    @Override
    public void handleRequest(String request) {
        if ("project".equals(request)) {
            System.out.println("Director handles project request");
        } else if (successor != null) {
            successor.handleRequest(request);
        }
    }
}

// ä½¿ç”¨
Handler manager = new Manager();
Handler director = new Director();
manager.setSuccessor(director);

manager.handleRequest("salary"); // Manager handles salary request
manager.handleRequest("project"); // Director handles project request
```

#### 14. å‘½ä»¤æ¨¡å¼ï¼ˆCommandï¼‰

**æ¯”å–»**ï¼šå°±åƒç‚¹é¤ï¼Œä½ ç‚¹èœï¼ˆå‘½ä»¤ï¼‰ç»™æœåŠ¡å‘˜ï¼ˆè°ƒç”¨è€…ï¼‰ï¼ŒæœåŠ¡å‘˜ä¼ ç»™å¨å¸ˆï¼ˆæ¥æ”¶è€…ï¼‰ã€‚

**åº”ç”¨åœºæ™¯**ï¼šå°†è¯·æ±‚å°è£…ä¸ºå¯¹è±¡ï¼Œå®ç°è§£è€¦ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// å‘½ä»¤æ¥å£
interface Command {
    void execute();
}

// æ¥æ”¶è€…
class Light {
    public void turnOn() {
        System.out.println("Light is on");
    }

    public void turnOff() {
        System.out.println("Light is off");
    }
}

// å…·ä½“å‘½ä»¤
class TurnOnLightCommand implements Command {
    private Light light;

    public TurnOnLightCommand(Light light) {
        this.light = light;
    }

    @Override
    public void execute() {
        light.turnOn();
    }
}

class TurnOffLightCommand implements Command {
    private Light light;

    public TurnOffLightCommand(Light light) {
        this.light = light;
    }

    @Override
    public void execute() {
        light.turnOff();
    }
}

// è°ƒç”¨è€…
class RemoteControl {
    private Command command;

    public void setCommand(Command command) {
        this.command = command;
    }

    public void pressButton() {
        command.execute();
    }
}

// ä½¿ç”¨
Light light = new Light();
Command turnOn = new TurnOnLightCommand(light);
Command turnOff = new TurnOffLightCommand(light);

RemoteControl remote = new RemoteControl();
remote.setCommand(turnOn);
remote.pressButton(); // Light is on

remote.setCommand(turnOff);
remote.pressButton(); // Light is off
```

#### 15. è§£æå™¨æ¨¡å¼ï¼ˆInterpreterï¼‰

**æ¯”å–»**ï¼šå°±åƒè¯­è¨€ç¿»è¯‘ï¼ŒæŠŠè‡ªç„¶è¯­è¨€è½¬æ¢æˆè®¡ç®—æœºèƒ½ç†è§£çš„æŒ‡ä»¤ã€‚

**åº”ç”¨åœºæ™¯**ï¼šå®šä¹‰è¯­è¨€çš„æ–‡æ³•ï¼Œå¹¶è§£é‡Šè¯¥è¯­è¨€çš„å¥å­ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// è¡¨è¾¾å¼æ¥å£
interface Expression {
    boolean interpret(String context);
}

// ç»ˆç»“ç¬¦è¡¨è¾¾å¼
class TerminalExpression implements Expression {
    private String data;

    public TerminalExpression(String data) {
        this.data = data;
    }

    @Override
    public boolean interpret(String context) {
        return context.contains(data);
    }
}

// éç»ˆç»“ç¬¦è¡¨è¾¾å¼
class OrExpression implements Expression {
    private Expression expr1;
    private Expression expr2;

    public OrExpression(Expression expr1, Expression expr2) {
        this.expr1 = expr1;
        this.expr2 = expr2;
    }

    @Override
    public boolean interpret(String context) {
        return expr1.interpret(context) || expr2.interpret(context);
    }
}

// ä½¿ç”¨
Expression isMale = new TerminalExpression("Male");
Expression isMarried = new TerminalExpression("Married");

Expression expression = new OrExpression(isMale, isMarried);
System.out.println(expression.interpret("Male")); // true
System.out.println(expression.interpret("Married")); // true
System.out.println(expression.interpret("Single")); // false
```

#### 16. è¿­ä»£å™¨æ¨¡å¼ï¼ˆIteratorï¼‰

**æ¯”å–»**ï¼šå°±åƒç¿»ä¹¦ï¼Œä½ ä¸éœ€è¦çŸ¥é“ä¹¦çš„å†…éƒ¨ç»“æ„ï¼Œåªéœ€è¦æŒ‰é¡ºåºä¸€é¡µé¡µç¿»ã€‚

**åº”ç”¨åœºæ™¯**ï¼šæä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡çš„å„ä¸ªå…ƒç´ ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// è¿­ä»£å™¨æ¥å£
interface Iterator {
    boolean hasNext();
    Object next();
}

// èšåˆ
interface Aggregate {
    Iterator createIterator();
}

// å…·ä½“è¿­ä»£å™¨
class BookShelfIterator implements Iterator {
    private BookShelf bookShelf;
    private int index;

    public BookShelfIterator(BookShelf bookShelf) {
        this.bookShelf = bookShelf;
        this.index = 0;
    }

    @Override
    public boolean hasNext() {
        return index < bookShelf.getSize();
    }

    @Override
    public Object next() {
        Book book = bookShelf.getBook(index);
        index++;
        return book;
    }
}

// å…·ä½“èšåˆ
class BookShelf implements Aggregate {
    private List<Book> books = new ArrayList<>();

    public void addBook(Book book) {
        books.add(book);
    }

    public Book getBook(int index) {
        return books.get(index);
    }

    public int getSize() {
        return books.size();
    }

    @Override
    public Iterator createIterator() {
        return new BookShelfIterator(this);
    }
}

// ä½¿ç”¨
BookShelf bookShelf = new BookShelf();
bookShelf.addBook(new Book("Book1"));
bookShelf.addBook(new Book("Book2"));
bookShelf.addBook(new Book("Book3"));

Iterator iterator = bookShelf.createIterator();
while (iterator.hasNext()) {
    System.out.println(iterator.next()); // Book1, Book2, Book3
}
```

#### 17. ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediatorï¼‰

**æ¯”å–»**ï¼šå°±åƒå¾®ä¿¡ç¾¤ï¼Œå¤§å®¶ä¸éœ€è¦ç›´æ¥äº’ç›¸è”ç³»ï¼Œåªéœ€è¦é€šè¿‡ç¾¤ä¸»ï¼ˆä¸­ä»‹è€…ï¼‰æ²Ÿé€šã€‚

**åº”ç”¨åœºæ™¯**ï¼šç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—å¯¹è±¡ä¹‹é—´çš„äº¤äº’ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// ä¸­ä»‹è€…
interface Mediator {
    void send(String message, Colleague colleague);
}

// åŒäº‹
abstract class Colleague {
    protected Mediator mediator;

    public Colleague(Mediator mediator) {
        this.mediator = mediator;
    }

    public abstract void receive(String message);
}

// å…·ä½“åŒäº‹
class ConcreteColleague1 extends Colleague {
    public ConcreteColleague1(Mediator mediator) {
        super(mediator);
    }

    @Override
    public void receive(String message) {
        System.out.println("Colleague1 received: " + message);
    }

    public void send(String message) {
        mediator.send(message, this);
    }
}

class ConcreteColleague2 extends Colleague {
    public ConcreteColleague2(Mediator mediator) {
        super(mediator);
    }

    @Override
    public void receive(String message) {
        System.out.println("Colleague2 received: " + message);
    }

    public void send(String message) {
        mediator.send(message, this);
    }
}

// å…·ä½“ä¸­ä»‹è€…
class ConcreteMediator implements Mediator {
    private ConcreteColleague1 colleague1;
    private ConcreteColleague2 colleague2;

    public void setColleague1(ConcreteColleague1 colleague1) {
        this.colleague1 = colleague1;
    }

    public void setColleague2(ConcreteColleague2 colleague2) {
        this.colleague2 = colleague2;
    }

    @Override
    public void send(String message, Colleague colleague) {
        if (colleague == colleague1) {
            colleague2.receive(message);
        } else {
            colleague1.receive(message);
        }
    }
}

// ä½¿ç”¨
ConcreteMediator mediator = new ConcreteMediator();
ConcreteColleague1 colleague1 = new ConcreteColleague1(mediator);
ConcreteColleague2 colleague2 = new ConcreteColleague2(mediator);
mediator.setColleague1(colleague1);
mediator.setColleague2(colleague2);

colleague1.send("Hello from Colleague1"); // Colleague2 received: Hello from Colleague1
colleague2.send("Hello from Colleague2"); // Colleague1 received: Hello from Colleague2
```

#### 18. å¤‡å¿˜å½•æ¨¡å¼ï¼ˆMementoï¼‰

**æ¯”å–»**ï¼šå°±åƒæ¸¸æˆå­˜æ¡£ï¼Œä½ å¯ä»¥éšæ—¶ä¿å­˜çŠ¶æ€ï¼Œéœ€è¦æ—¶æ¢å¤ã€‚

**åº”ç”¨åœºæ™¯**ï¼šåœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·å¹¶å¤–éƒ¨åŒ–å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// å¤‡å¿˜å½•
class Memento {
    private String state;

    public Memento(String state) {
        this.state = state;
    }

    public String getState() {
        return state;
    }
}

// å‘èµ·è€…
class Originator {
    private String state;

    public void setState(String state) {
        this.state = state;
    }

    public String getState() {
        return state;
    }

    public Memento saveStateToMemento() {
        return new Memento(state);
    }

    public void getStateFromMemento(Memento memento) {
        state = memento.getState();
    }
}

// ç®¡ç†è€…
class CareTaker {
    private List<Memento> mementoList = new ArrayList<>();

    public void addMemento(Memento memento) {
        mementoList.add(memento);
    }

    public Memento getMemento(int index) {
        return mementoList.get(index);
    }
}

// ä½¿ç”¨
Originator originator = new Originator();
CareTaker careTaker = new CareTaker();

originator.setState("State1");
careTaker.addMemento(originator.saveStateToMemento());

originator.setState("State2");
careTaker.addMemento(originator.saveStateToMemento());

originator.setState("State3");
System.out.println("Current State: " + originator.getState()); // State3

originator.getStateFromMemento(careTaker.getMemento(0));
System.out.println("Restored State: " + originator.getState()); // State1
```

#### 19. è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserverï¼‰

**æ¯”å–»**ï¼šå°±åƒå¤©æ°”é¢„æŠ¥ï¼Œä½ è®¢é˜…äº†å¤©æ°”ï¼Œå¤©æ°”å˜åŒ–æ—¶ä¼šæ”¶åˆ°é€šçŸ¥ã€‚

**åº”ç”¨åœºæ™¯**ï¼šå½“å¯¹è±¡é—´å­˜åœ¨ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»æ—¶ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// è§‚å¯Ÿè€…
interface Observer {
    void update(String message);
}

// ä¸»é¢˜
interface Subject {
    void registerObserver(Observer observer);
    void removeObserver(Observer observer);
    void notifyObservers();
}

// å…·ä½“ä¸»é¢˜
class WeatherData implements Subject {
    private List<Observer> observers = new ArrayList<>();
    private float temperature;

    public void setTemperature(float temperature) {
        this.temperature = temperature;
        notifyObservers();
    }

    @Override
    public void registerObserver(Observer observer) {
        observers.add(observer);
    }

    @Override
    public void removeObserver(Observer observer) {
        observers.remove(observer);
    }

    @Override
    public void notifyObservers() {
        for (Observer observer : observers) {
            observer.update("Temperature: " + temperature);
        }
    }
}

// å…·ä½“è§‚å¯Ÿè€…
class TemperatureDisplay implements Observer {
    @Override
    public void update(String message) {
        System.out.println("TemperatureDisplay: " + message);
    }
}

class WeatherStation {
    public static void main(String[] args) {
        WeatherData weatherData = new WeatherData();
        Observer display = new TemperatureDisplay();

        weatherData.registerObserver(display);
        weatherData.setTemperature(25.5f); // TemperatureDisplay: Temperature: 25.5
    }
}
```

#### 20. çŠ¶æ€æ¨¡å¼ï¼ˆStateï¼‰

**æ¯”å–»**ï¼šå°±åƒæ‰‹æœºçŠ¶æ€ï¼Œå¾…æœºã€é€šè¯ã€æ¸¸æˆï¼Œä¸åŒçŠ¶æ€ä¸‹åŠŸèƒ½ä¸åŒã€‚

**åº”ç”¨åœºæ™¯**ï¼šå¯¹è±¡çš„è¡Œä¸ºä¾èµ–äºå®ƒçš„çŠ¶æ€ï¼Œå¹¶ä¸”å¯ä»¥è¿è¡Œæ—¶æ”¹å˜çŠ¶æ€ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// çŠ¶æ€æ¥å£
interface State {
    void handleRequest();
}

// å…·ä½“çŠ¶æ€
class ConcreteStateA implements State {
    @Override
    public void handleRequest() {
        System.out.println("ConcreteStateA handles request");
    }
}

class ConcreteStateB implements State {
    @Override
    public void handleRequest() {
        System.out.println("ConcreteStateB handles request");
    }
}

// ä¸Šä¸‹æ–‡
class Context {
    private State state;

    public Context(State state) {
        this.state = state;
    }

    public void setState(State state) {
        this.state = state;
    }

    public void request() {
        state.handleRequest();
    }
}

// ä½¿ç”¨
Context context = new Context(new ConcreteStateA());
context.request(); // ConcreteStateA handles request

context.setState(new ConcreteStateB());
context.request(); // ConcreteStateB handles request
```

#### 21. ç­–ç•¥æ¨¡å¼ï¼ˆStrategyï¼‰

**æ¯”å–»**ï¼šå°±åƒå¤–å–é€‰æ‹©é…é€æ–¹å¼ï¼Œé›¨å¤©ç”¨ç”µåŠ¨è½¦ï¼Œæ™´å¤©ç”¨è‡ªè¡Œè½¦ï¼Œæ™šé«˜å³°ç”¨æ‘©æ‰˜ã€‚

**åº”ç”¨åœºæ™¯**ï¼šå®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼ŒæŠŠå®ƒä»¬å°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// ç­–ç•¥æ¥å£
interface Strategy {
    void execute();
}

// å…·ä½“ç­–ç•¥
class ConcreteStrategyA implements Strategy {
    @Override
    public void execute() {
        System.out.println("Executing strategy A");
    }
}

class ConcreteStrategyB implements Strategy {
    @Override
    public void execute() {
        System.out.println("Executing strategy B");
    }
}

// ä¸Šä¸‹æ–‡
class Context {
    private Strategy strategy;

    public Context(Strategy strategy) {
        this.strategy = strategy;
    }

    public void setStrategy(Strategy strategy) {
        this.strategy = strategy;
    }

    public void executeStrategy() {
        strategy.execute();
    }
}

// ä½¿ç”¨
Context context = new Context(new ConcreteStrategyA());
context.executeStrategy(); // Executing strategy A

context.setStrategy(new ConcreteStrategyB());
context.executeStrategy(); // Executing strategy B
```

#### 22. æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplate Methodï¼‰

**æ¯”å–»**ï¼šå°±åƒåšå’–å•¡çš„æµç¨‹ï¼šçƒ§æ°´ â†’ åŠ å’–å•¡ç²‰ â†’ å†²æ³¡ â†’ æ…æ‹Œï¼Œå­ç±»åªæ”¹"åŠ å¥¶è¿˜æ˜¯ç³–"ã€‚

**åº”ç”¨åœºæ™¯**ï¼šå®šä¹‰ä¸€ä¸ªç®—æ³•çš„æ¡†æ¶ï¼Œå…è®¸å­ç±»åœ¨ä¸æ”¹å˜ç»“æ„çš„æƒ…å†µä¸‹é‡å†™æ­¥éª¤ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// æŠ½è±¡ç±»
abstract class CaffeineBeverage {
    final void prepareRecipe() {
        boilWater();
        brew();
        pourInCup();
        addCondiments();
    }

    abstract void brew();
    abstract void addCondiments();

    void boilWater() {
        System.out.println("Boiling water");
    }

    void pourInCup() {
        System.out.println("Pouring into cup");
    }
}

// å…·ä½“å®ç°
class Tea extends CaffeineBeverage {
    @Override
    void brew() {
        System.out.println("Steeping the tea");
    }

    @Override
    void addCondiments() {
        System.out.println("Adding lemon");
    }
}

class Coffee extends CaffeineBeverage {
    @Override
    void brew() {
        System.out.println("Dripping coffee through filter");
    }

    @Override
    void addCondiments() {
        System.out.println("Adding sugar and milk");
    }
}

// ä½¿ç”¨
CaffeineBeverage tea = new Tea();
tea.prepareRecipe();
// è¾“å‡ºï¼š
// Boiling water
// Steeping the tea
// Pouring into cup
// Adding lemon

CaffeineBeverage coffee = new Coffee();
coffee.prepareRecipe();
// è¾“å‡ºï¼š
// Boiling water
// Dripping coffee through filter
// Pouring into cup
// Adding sugar and milk
```

#### 23. è®¿é—®è€…æ¨¡å¼ï¼ˆVisitorï¼‰

**æ¯”å–»**ï¼šå°±åƒåŒ»é™¢ä½“æ£€ï¼Œä¸€é˜ŸåŒ»ç”Ÿï¼ˆè®¿é—®è€…ï¼‰è½®æµæ£€æŸ¥ä½ èº«ä½“æ¯ä¸ªå™¨å®˜ã€‚

**åº”ç”¨åœºæ™¯**ï¼šå¯¹ä¸€ä¸ªå¯¹è±¡ç»“æ„ä¸­çš„å…ƒç´ è¿›è¡Œæ“ä½œï¼Œä¸æ”¹å˜å…ƒç´ çš„ç±»ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// è®¿é—®è€…æ¥å£
interface Visitor {
    void visit(Animal animal);
    void visit(Plant plant);
}

// å…·ä½“è®¿é—®è€…
class ZooKeeper implements Visitor {
    @Override
    public void visit(Animal animal) {
        System.out.println("ZooKeeper feeding " + animal.getName());
    }

    @Override
    public void visit(Plant plant) {
        System.out.println("ZooKeeper watering " + plant.getName());
    }
}

// å…ƒç´ æ¥å£
interface Element {
    void accept(Visitor visitor);
}

// å…·ä½“å…ƒç´ 
class Animal implements Element {
    private String name;

    public Animal(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }

    @Override
    public void accept(Visitor visitor) {
        visitor.visit(this);
    }
}

class Plant implements Element {
    private String name;

    public Plant(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }

    @Override
    public void accept(Visitor visitor) {
        visitor.visit(this);
    }
}

// ä½¿ç”¨
Element animal = new Animal("Lion");
Element plant = new Plant("Tree");

Visitor zooKeeper = new ZooKeeper();
animal.accept(zooKeeper); // ZooKeeper feeding Lion
plant.accept(zooKeeper); // ZooKeeper watering Tree
```

## ğŸ’¡ ä¸ºä»€ä¹ˆå­¦ä¹ è®¾è®¡æ¨¡å¼ï¼Ÿ

è®¾è®¡æ¨¡å¼ä¸æ˜¯"å¿…é¡»ç”¨"çš„é­”æ³•ï¼Œè€Œæ˜¯"çŸ¥é“æ—¶èƒ½ç”¨"çš„å·¥å…·ã€‚å°±åƒä½ ä¸ä¼šæ¯é¡¿é¥­éƒ½ç”¨åˆ€å‰ï¼Œä½†çŸ¥é“æ€ä¹ˆç”¨æ‰èƒ½åƒå¾—æ›´å¥½ã€‚

**"è®¾è®¡æ¨¡å¼ä¸æ˜¯ç›®çš„ï¼Œè€Œæ˜¯æ‰‹æ®µï¼›ä¸æ˜¯ä¸ºäº†ç”¨è€Œç”¨ï¼Œè€Œæ˜¯ä¸ºäº†æ›´å¥½åœ°è§£å†³é—®é¢˜ã€‚"**
